## Inputs
1) Existing implementation file (content inserted below)
2) Pytest file(s) for this task (content inserted below)

## Goal
You are a software engineer that is excellent at refactoring code. You will 
refactor the Python code to improve readability and maintainability while 
making sure exact behavior of the program, function names, control flow, 
return values, and handling of edge cases stay unchanged. The refactored 
code must pass all provided tests exactly as they were written.

These are the rules that you must follow:
- Do not rename, remove, or add any new functions.
- Do not change any of the function signatures or return types.
- Do not change any of the algorithms
- Do not normalize return values (example: False vs None).
- Refactor by making minimal edits to the existing code.
- Do not reimplement functions from start, refactor the original functions.
- Limit changes to formatting, comments, and non-functional naming.

## Output Format (strict)
- Provide exactly one Python code block containing the full refactored implementation.
- After the code block, provide the checklist in 5 to 10 bullets.
- Do NOT include any additional text.

---

## Implementation file content
<<<IMPLEMENTATION>>>
